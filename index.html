Dom≈Ø
Finance
Cestov√°n√≠
Akademick√©
Sporty
Knihovna
M√°m k√≥d z Google scripts: "// =============================================================== // KO
m≈Ø≈æe≈° prohledat m≈Øj notion √∫ƒçet?
Tak≈æe je mo≈æn√©, kdy≈æ to propoj√≠m, pou≈æ√≠vat Perplexity u umƒõlou inteligenci, aby mi tam p≈ôid√°vala nƒõj
P≈ôedprodeji a po≈ô√°d nejsou k dispozici na Alze, tak≈æe zjist√≠, kdy budou dostupn√© v ƒåesku.
soundslice - jak finaln√≠ takt. ƒç√°ru aby nehr√°lo d√°l?
auto pitch corection v reaperu saxofon solo
nƒõjak√° mo≈ænost zkusit elementor nebo podobn√Ω visual editor online bez p≈ôihl√°≈°en√≠ a vytv√°≈ôen√≠ WP inst
u≈æ jsou nƒõkde v prodeji v CZ apple airpods pro 3 nebo jen p≈ôedobjedn√°vky? na alze mƒõly b√Ωt 19.9. ale
uprav podle pokyn≈Ø a souboru csv n√°sleduj√≠c√≠ informace:"Tak≈æe m√°me p√≠sniƒçky. Bƒõ≈æela oveƒçka, potom ƒçe
Kod: ‚Äú// =============================================================== // KONFIGURACE // =========
Zobrazit v≈°e
Dom≈Ø
Objevovat
Prostory
√öƒçet

Upgradovat
Nainstalovat
M√°m k√≥d z Google scripts: 
"// ===============================================================
// KONFIGURACE
// ===============================================================
const ID_TABULKY = '1I0oKF7oE82fzQD7gW_O8pjInNj-jWK2hh4Jly2ok3y4'; // ID va≈°√≠ tabulky

// Jednotn√Ω v√Ωstup HTML s povolen√≠m pro vkl√°d√°n√≠
function out(html) {
  return HtmlService
    .createHtmlOutput(html)
    .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

// ===============================================================
// HLAVN√ç FUNKCE WEBOV√â APLIKACE
// ===============================================================
function doGet(e) {
  try {
    const page = (e && e.parameter && e.parameter.page) ? String(e.parameter.page) : '';
    const data = nacistVsechnaData();

    if (!data) {
      return out('<h1>Chyba p≈ôi naƒç√≠t√°n√≠ dat z tabulky.</h1><p>Zkontrolujte n√°zvy list≈Ø v Google Sheets.</p>');
    }

    if (page) {
      const zak = data.zaci.find(z => normalizovatNazev(z['Cel√© jm√©no']) === page);
      if (zak) {
        return out(generovatHtmlProZaka(zak));
      } else {
        return out('<h1>≈Ω√°k "' + escapeHtml(page) + '" nenalezen</h1>');
      }
    } else {
      return out(generovatHtmlRozcestnik(data.zaci));
    }
  } catch (error) {
    Logger.log('ERROR: ' + error.toString());
    return out('<h1>Do≈°lo k chybƒõ skriptu.</h1><p>Detail: ' + escapeHtml(error.toString()) + '</p>');
  }
}

// ===============================================================
// POMOCN√â FUNKCE PRO Z√çSK√ÅN√ç A ZPRACOV√ÅN√ç DAT
// ===============================================================
function nacistVsechnaData() {
  const ss = SpreadsheetApp.openById(ID_TABULKY);
  const zaciSheet = ss.getSheetByName('≈Ω√°ci');
  const skladbySheet = ss.getSheetByName('Skladby');
  const denikSheet = ss.getSheetByName('Pracovn√≠ den√≠k');

  if (!zaciSheet || !skladbySheet || !denikSheet) return null;

  const zaci = sheetToObjectArray(zaciSheet);
  const denik = sheetToObjectArray(denikSheet);

  zaci.forEach(zak => {
    const jmenoZaka = zak['Cel√© jm√©no'];
    if (jmenoZaka) {
      // Se≈ôad√≠me √∫koly od nejnovƒõj≈°√≠ho po nejstar≈°√≠
      zak.ukoly = denik
        .filter(d => strEq(d['≈Ω√°k'], jmenoZaka))
        .sort((a, b) => new Date(b.Datum) - new Date(a.Datum));
    }
  });

  return { zaci };
}

// ===============================================================
// FUNKCE PRO GENEROV√ÅN√ç HTML
// ===============================================================
function generovatHtmlRozcestnik(zaci) {
  const baseUrl = ScriptApp.getService().getUrl();
  
  let html = `
    <!DOCTYPE html>
    <html>
      <head>
        <base target="_top">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; }
          .container { max-width: 1000px; margin: 0 auto; }
          h1 { margin: 0 0 18px 0; color: #1a2c4e; font-weight: 600; }
          .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
          .card { display: block; background: #fff; border-radius:16px; padding: 20px; box-shadow:0 5px 15px rgba(0,0,0,.07); text-decoration: none; color: inherit; transition: all 0.2s ease; }
          .card:hover { transform: translateY(-5px); box-shadow:0 8px 25px rgba(0,0,0,.1); }
          .card-icon { font-size:32px; line-height: 1; }
          .card h3 { margin:12px 0 0 0; font-size:1.1em; color: #1a2c4e; font-weight: 600; }
        </style>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
      </head>
      <body>
        <div class="container"><h1>Hudebn√≠ n√°stƒõnky</h1><div class="grid">
  `;

  zaci.forEach(zak => {
    if (zak && zak['Cel√© jm√©no']) {
      const slug = encodeURIComponent(normalizovatNazev(zak['Cel√© jm√©no']));
      const url = baseUrl + '?page=' + slug;
      html += `<a href="${url}" class="card"><div class="card-icon">üéº</div><h3>${escapeHtml(zak['Cel√© jm√©no'])}</h3></a>`;
    }
  });

  html += `</div></div></body></html>`;
  return html;
}

function generovatHtmlProZaka(zak) {
  const baseUrl = ScriptApp.getService().getUrl();
  const avatarData = getImageAsBase64(zak['avatar']);
  
  // Data pro Cviƒçen√≠ na p≈ô√≠≈°tƒõ a P≈ôedchoz√≠ √∫koly
  const cviceniNaPriste = zak.ukoly && zak.ukoly.length > 0 ? zak.ukoly[0] : null;
  const predchoziUkoly = zak.ukoly && zak.ukoly.length > 1 ? zak.ukoly.slice(1) : [];
  
  // Data pro Na ƒçem pracujeme a Pr≈Øbƒõh uƒçen√≠
  const nedokonceneSkladby = {};
  zak.ukoly.filter(ukol => ukol['Stav √∫kolu'] !== '‚úÖ Zvl√°dnuto').forEach(ukol => {
    const skladba = ukol['Skladba'];
    if (skladba) {
      if (!nedokonceneSkladby[skladba]) {
        nedokonceneSkladby[skladba] = { body: [], nazvy: [] };
      }
      nedokonceneSkladby[skladba].body.push(ukol['Body']);
      nedokonceneSkladby[skladba].nazvy.push(ukol['N√°zev √∫kolu']);
    }
  });
  
  let naCemPracujemeHTML = '';
  let pruvbehUcUeniHTML = '';
  
  for (const skladba in nedokonceneSkladby) {
    const body = nedokonceneSkladby[skladba].body.map(b => parseFloat(b) || 0);
    const totalBody = body.reduce((sum, current) => sum + current, 0);
    const maxMozneBody = body.length * 10;
    const procento = maxMozneBody > 0 ? (totalBody / maxMozneBody) * 100 : 0;
    const progressColor = procento === 100 ? '#50E3C2' : '#4A90E2';
    
    naCemPracujemeHTML += `<li>${escapeHtml(skladba)}</li>`;
    pruvbehUcUeniHTML += `
      <div class="progress-item">
        <div class="progress-label">${escapeHtml(skladba)}</div>
        <div class="progress-bar-container">
          <div class="progress-bar" style="width: ${procento}%; background-color: ${progressColor};">
            ${procento.toFixed(0)}%
          </div>
        </div>
      </div>
    `;
  }
  
  let html = `
    <!DOCTYPE html>
    <html>
      <head>
        <base target="_top">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
          html { scroll-behavior: smooth; }
          body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; }
          .container { max-width: 800px; margin: 0 auto; }
          .intro-panel { display: flex; align-items: center; justify-content: space-between; background: #fff; border-radius: 24px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); position: relative; }
          .intro-text { z-index: 1; }
          .intro-text h1 { font-size: 2em; font-weight: 600; color: #1a2c4e; margin: 0; }
          .intro-text p { font-size: 1.2em; color: #777; margin: 5px 0 20px 0; }
          .avatar { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.1); position: absolute; right: -50px; top: 50%; transform: translateY(-50%); z-index: 0; }
          .scroll-button { display: inline-block; background-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 12px 25px; border-radius: 50px; text-decoration: none; font-weight: 600; transition: all 0.3s; cursor: pointer; }
          .scroll-button:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(102, 126, 234, 0.3); }
          .section { background: #fff; border-radius: 16px; padding: 25px; margin: 30px 0; }
          .section-title { font-size: 1.6em; font-weight: 600; color: #1a2c4e; margin: 0 0 20px 0; }
          .task-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
          .task-table th, .task-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
          .task-table th { background-color: #f2f2f2; color: #555; }
          .task-table tr:hover { background-color: #f9f9f9; }
          .back-link { display:inline-block; margin-top: 20px; color:#667eea; text-decoration:none; font-weight: 600; }
          .two-column-layout { display: flex; gap: 40px; margin: 40px 0; }
          .column { flex: 1; min-width: 0; }
          .progress-item { margin-bottom: 12px; }
          .progress-label { margin-bottom: 5px; font-size: 14px; color: #555; }
          .progress-bar-container { width: 100%; background-color: #EAE9E4; border-radius: 5px; overflow: hidden; }
          .progress-bar { height: 20px; background-color: #4A90E2; text-align: right; line-height: 20px; color: white; font-size: 12px; font-weight: bold; padding-right: 8px; border-radius: 5px 0 0 5px; }
          @media (max-width: 768px) { .two-column-layout { flex-direction: column; } .avatar { display: none; } }
        </style>
        <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
      </head>
      <body>
        <div class="container">
          <div class="intro-panel">
            <div class="intro-text">
              <h1>${escapeHtml(zak['osloven√≠ 2. p√°d'])} Hudebn√≠ cesta</h1>
              <p>Hudebn√≠ n√°stroj: ${escapeHtml(zak['P≈ôedmƒõt'] || '')}, Roƒçn√≠k: ${escapeHtml(zak['Roƒçn√≠k'] || '')}</p>
              <a onclick="scrollDown()" class="scroll-button">Zobrazit, co cviƒçit na p≈ô√≠≈°tƒõ</a>
            </div>
            <img src="${avatarData}" alt="Avatar" class="avatar">
          </div>

          <div class="two-column-layout">
              <div class="column">
                <h2 class="section-title">Na ƒçem pracujeme</h2>
                <ul style="list-style: 'üéµ  '; padding-left: 20px;">
                  ${naCemPracujemeHTML}
                </ul>
              </div>
              <div class="column">
                <h2 class="section-title">Pr≈Øbƒõh uƒçen√≠</h2>
                ${pruvbehUcUeniHTML}
              </div>
          </div>
  `;

  // Sekce: Cviƒçen√≠ na p≈ô√≠≈°tƒõ
  html += `<div class="section" id="cviceni-na-priste"><h2 class="section-title">Cviƒçen√≠ na p≈ô√≠≈°tƒõ</h2>`;
  if (cviceniNaPriste) {
    html += `
      <table class="task-table">
        <thead>
          <tr>
            <th>Skladba</th>
            <th>N√°zev √∫kolu</th>
            <th>Status</th>
            <th>Datum</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>${escapeHtml(cviceniNaPriste['Skladba'])}</td>
            <td>${escapeHtml(cviceniNaPriste['N√°zev √∫kolu'])}</td>
            <td>${escapeHtml(cviceniNaPriste['Stav √∫kolu'])}</td>
            <td>${safeDateToCz(cviceniNaPriste['Datum'])}</td>
          </tr>
        </tbody>
      </table>
    `;
  } else {
    html += '<p>≈Ω√°dn√© nov√© cviƒçen√≠ nebylo zad√°no.</p>';
  }
  html += `</div>`;

  // Sekce: P≈ôedchoz√≠ √∫koly
  if (predchoziUkoly.length > 0) {
    html += `<div class="section"><h2 class="section-title">P≈ôedchoz√≠ √∫koly</h2>
      <table class="task-table">
        <thead>
          <tr>
            <th>Skladba</th>
            <th>N√°zev √∫kolu</th>
            <th>Status</th>
            <th>Datum</th>
          </tr>
        </thead>
        <tbody>`;
    predchoziUkoly.forEach(ukol => {
      html += `
        <tr>
          <td>${escapeHtml(ukol['Skladba'])}</td>
          <td>${escapeHtml(ukol['N√°zev √∫kolu'])}</td>
          <td>${escapeHtml(ukol['Stav √∫kolu'])}</td>
          <td>${safeDateToCz(ukol['Datum'])}</td>
        </tr>
      `;
    });
    html += `</tbody></table></div>`;
  }

  html += `<a href="${baseUrl}" class="back-link">‚Üê Zpƒõt na rozcestn√≠k</a>`;
  html += `</div>
      <script>
        function scrollDown() {
          var target = document.getElementById('cviceni-na-priste');
          if (target) {
            target.scrollIntoView({ behavior: 'smooth' });
          }
        }
      </script>
  </body></html>`;
  return html;
}

// ===============================================================
// UNIVERZ√ÅLN√ç POMOCN√â FUNKCE
// ===============================================================
function sheetToObjectArray(sheet) {
  if (!sheet) return [];
  const values = sheet.getDataRange().getValues();
  if (!values || values.length < 2) return [];
  const headers = values.shift().map(h => (typeof h === 'string' ? h.trim() : h));

  return values.map(row => {
    const obj = {};
    headers.forEach((header, i) => {
      let val = row[i];
      if (typeof val === 'string') val = val.trim();
      obj[header] = (val === null || val === undefined) ? '' : val;
    });
    return obj;
  });
}

function getImageAsBase64(url) {
  if (!url || typeof url !== 'string') return 'https://via.placeholder.com/100';
  
  // Zkus√≠me nejd≈ô√≠ve naƒç√≠st obr√°zek z Drive
  const driveIdMatch = url.match(/file\/d\/([a-zA-Z0-9_-]+)/);
  if (driveIdMatch && driveIdMatch[1]) {
    try {
      const file = DriveApp.getFileById(driveIdMatch[1]);
      const blob = file.getBlob();
      return 'data:' + blob.getContentType() + ';base64,' + Utilities.base64Encode(blob.getBytes());
    } catch(e) {
      Logger.log('Nepoda≈ôilo se naƒç√≠st obr√°zek z Google Drive: ' + e.toString());
    }
  }

  // Pokud je to URL z jin√©ho webu
  try {
    const response = UrlFetchApp.fetch(url, { muteHttpExceptions: true });
    if (response.getResponseCode() == 200) {
      const blob = response.getBlob();
      return 'data:' + blob.getContentType() + ';base64,' + Utilities.base64Encode(blob.getBytes());
    }
  } catch(e) {
    Logger.log('Nepoda≈ôilo se naƒç√≠st obr√°zek z extern√≠ URL: ' + e.toString());
  }

  return 'https://via.placeholder.com/100';
}

function normalizovatNazev(text) {
  if (!text) return '';
  return text.toString().toLowerCase().replace(/\s+/g, '-').normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-z0-9-]/g, '');
}

function normStr(s) { return s == null ? '' : s.toString().trim(); }
function strEq(a, b) { return normStr(a) === normStr(b); }

function safeDateToCz(d) {
  try {
    if (!d) return '';
    const date = new Date(d);
    return isNaN(date.getTime()) ? '' : date.toLocaleDateString('cs-CZ');
  } catch (e) { return ''; }
}

function escapeHtml(s) {
  if (s == null) return '';
  return s.toString().replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, ''');
}"
1. zmen≈°i √∫vodn√≠ nadpis **Hudebn√≠ cesta, proto≈æe p≈ôekr√Ωv√° Avatar.** - na v≈°ech za≈ô√≠zen√≠ch aby byl ok.
2. **Sekce Na ƒçem pracujeme  a ‚ÄúPr≈Øbƒõh uƒçen√≠‚Äù dej  taky do b√≠l√Ωch box≈Ø.** 
3. **‚ÄúCviƒçen√≠ na p≈ô√≠≈°tƒõ‚Äù by mƒõly b√Ωt v≈°echny kter√© nemaj√≠ status ‚Äú‚úÖ Zvl√°dnuto‚Äù ne jenom jedno. S ‚Äú‚úÖ Zvl√°dnuto‚Äù bude pak v ‚ÄúP≈ôedchoz√≠ √∫koly‚Äù**
4. **Pr≈Øbƒõh uƒçen√≠ - progres bary budou jen 1-10 bod≈Ø (10 dokonƒçeno) ne na procenta.**
5. Udƒõlat ≈°ir≈°√≠, nyn√≠ zab√≠r√° jen p≈Øl obrazovky. z√°rove≈à mus√≠ b√Ωt responzivn√≠ i pro mobily apod.
6. v ‚Äú**Cviƒçen√≠ na p≈ô√≠≈°tƒõ ‚Äúa ‚ÄúP≈ôedchoz√≠ √∫koly‚Äù je prvn√≠** sloupec ‚ÄúSkladba‚Äù - p≈ôi kliknut√≠ na skladbu se rozev≈ôe seznam Materi√°l≈Ø (url) jako rozbalovac√≠ nab√≠dka - z listu Skaldby sloupec ‚ÄúMateri√°ly‚Äù - m≈Ø≈æe tam b√Ωt v√≠ce url oddƒõlen√© ƒç√°rkami. Dal≈°√≠ ≈ô√°dky pod t√≠m se p≈ôi tom posunou dol≈Ø.

M√°m k√≥d z Google scripts: "// =============================================================== // KONFIGURACE // =============================================================== const ID_TABULKY = '1I0oKF7oE82fzQD7gW_O8pjInNj-jWK2hh4Jly2ok3y4'; // ID va≈°√≠ tabulky // Jednotn√Ω v√Ωstup HTML s povolen√≠m pro vkl√°d√°n√≠ function out(html) { return HtmlService .createHtmlOutput(html) .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL); } // =============================================================== // HLAVN√ç FUNKCE WEBOV√â APLIKACE // =============================================================== function doGet(e) { try { const page = (e && e.parameter && e.parameter.page) ? String(e.parameter.page) : ''; const data = nacistVsechnaData(); if (!data) { return out('<h1>Chyba p≈ôi naƒç√≠t√°n√≠ dat z tabulky.</h1><p>Zkontrolujte n√°zvy list≈Ø v Google Sheets.</p>'); } if (page) { const zak = data.zaci.find(z => normalizovatNazev(z['Cel√© jm√©no']) === page); if (zak) { return out(generovatHtmlProZaka(zak)); } else { return out('<h1>≈Ω√°k "' + escapeHtml(page) + '" nenalezen</h1>'); } } else { return out(generovatHtmlRozcestnik(data.zaci)); } } catch (error) { Logger.log('ERROR: ' + error.toString()); return out('<h1>Do≈°lo k chybƒõ skriptu.</h1><p>Detail: ' + escapeHtml(error.toString()) + '</p>'); } } // =============================================================== // POMOCN√â FUNKCE PRO Z√çSK√ÅN√ç A ZPRACOV√ÅN√ç DAT // =============================================================== function nacistVsechnaData() { const ss = SpreadsheetApp.openById(ID_TABULKY); const zaciSheet = ss.getSheetByName('≈Ω√°ci'); const skladbySheet = ss.getSheetByName('Skladby'); const denikSheet = ss.getSheetByName('Pracovn√≠ den√≠k'); if (!zaciSheet || !skladbySheet || !denikSheet) return null; const zaci = sheetToObjectArray(zaciSheet); const denik = sheetToObjectArray(denikSheet); zaci.forEach(zak => { const jmenoZaka = zak['Cel√© jm√©no']; if (jmenoZaka) { // Se≈ôad√≠me √∫koly od nejnovƒõj≈°√≠ho po nejstar≈°√≠ zak.ukoly = denik .filter(d => strEq(d['≈Ω√°k'], jmenoZaka)) .sort((a, b) => new Date(b.Datum) - new Date(a.Datum)); } }); return { zaci }; } // =============================================================== // FUNKCE PRO GENEROV√ÅN√ç HTML // =============================================================== function generovatHtmlRozcestnik(zaci) { const baseUrl = ScriptApp.getService().getUrl(); let html = ` <!DOCTYPE html> <html> <head> <base target="_top"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <style> body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; } .container { max-width: 1000px; margin: 0 auto; } h1 { margin: 0 0 18px 0; color: #1a2c4e; font-weight: 600; } .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; } .card { display: block; background: #fff; border-radius:16px; padding: 20px; box-shadow:0 5px 15px rgba(0,0,0,.07); text-decoration: none; color: inherit; transition: all 0.2s ease; } .card:hover { transform: translateY(-5px); box-shadow:0 8px 25px rgba(0,0,0,.1); } .card-icon { font-size:32px; line-height: 1; } .card h3 { margin:12px 0 0 0; font-size:1.1em; color: #1a2c4e; font-weight: 600; } </style> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"> </head> <body> <div class="container"><h1>Hudebn√≠ n√°stƒõnky</h1><div class="grid"> `; zaci.forEach(zak => { if (zak && zak['Cel√© jm√©no']) { const slug = encodeURIComponent(normalizovatNazev(zak['Cel√© jm√©no'])); const url = baseUrl + '?page=' + slug; html += `<a href="${url}" class="card"><div class="card-icon">üéº</div><h3>${escapeHtml(zak['Cel√© jm√©no'])}</h3></a>`; } }); html += `</div></div></body></html>`; return html; } function generovatHtmlProZaka(zak) { const baseUrl = ScriptApp.getService().getUrl(); const avatarData = getImageAsBase64(zak['avatar']); // Data pro Cviƒçen√≠ na p≈ô√≠≈°tƒõ a P≈ôedchoz√≠ √∫koly const cviceniNaPriste = zak.ukoly && zak.ukoly.length > 0 ? zak.ukoly[0] : null; const predchoziUkoly = zak.ukoly && zak.ukoly.length > 1 ? zak.ukoly.slice(1) : []; // Data pro Na ƒçem pracujeme a Pr≈Øbƒõh uƒçen√≠ const nedokonceneSkladby = {}; zak.ukoly.filter(ukol => ukol['Stav √∫kolu'] !== '‚úÖ Zvl√°dnuto').forEach(ukol => { const skladba = ukol['Skladba']; if (skladba) { if (!nedokonceneSkladby[skladba]) { nedokonceneSkladby[skladba] = { body: [], nazvy: [] }; } nedokonceneSkladby[skladba].body.push(ukol['Body']); nedokonceneSkladby[skladba].nazvy.push(ukol['N√°zev √∫kolu']); } }); let naCemPracujemeHTML = ''; let pruvbehUcUeniHTML = ''; for (const skladba in nedokonceneSkladby) { const body = nedokonceneSkladby[skladba].body.map(b => parseFloat(b) || 0); const totalBody = body.reduce((sum, current) => sum + current, 0); const maxMozneBody = body.length * 10; const procento = maxMozneBody > 0 ? (totalBody / maxMozneBody) * 100 : 0; const progressColor = procento === 100 ? '#50E3C2' : '#4A90E2'; naCemPracujemeHTML += `<li>${escapeHtml(skladba)}</li>`; pruvbehUcUeniHTML += ` <div class="progress-item"> <div class="progress-label">${escapeHtml(skladba)}</div> <div class="progress-bar-container"> <div class="progress-bar" style="width: ${procento}%; background-color: ${progressColor};"> ${procento.toFixed(0)}% </div> </div> </div> `; } let html = ` <!DOCTYPE html> <html> <head> <base target="_top"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <style> html { scroll-behavior: smooth; } body { font-family: 'Poppins', sans-serif; background-color: #f0f2f5; color: #333; margin: 0; padding: 20px; } .container { max-width: 800px; margin: 0 auto; } .intro-panel { display: flex; align-items: center; justify-content: space-between; background: #fff; border-radius: 24px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); position: relative; } .intro-text { z-index: 1; } .intro-text h1 { font-size: 2em; font-weight: 600; color: #1a2c4e; margin: 0; } .intro-text p { font-size: 1.2em; color: #777; margin: 5px 0 20px 0; } .avatar { width: 250px; height: 250px; border-radius: 50%; object-fit: cover; border: none; box-shadow: 0 4px 15px rgba(0,0,0,0.1); position: absolute; right: -50px; top: 50%; transform: translateY(-50%); z-index: 0; } .scroll-button { display: inline-block; background-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: #fff; padding: 12px 25px; border-radius: 50px; text-decoration: none; font-weight: 600; transition: all 0.3s; cursor: pointer; } .scroll-button:hover { transform: translateY(-3px); box-shadow: 0 8px 15px rgba(102, 126, 234, 0.3); } .section { background: #fff; border-radius: 16px; padding: 25px; margin: 30px 0; } .section-title { font-size: 1.6em; font-weight: 600; color: #1a2c4e; margin: 0 0 20px 0; } .task-table { width: 100%; border-collapse: collapse; margin-top: 10px; } .task-table th, .task-table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; } .task-table th { background-color: #f2f2f2; color: #555; } .task-table tr:hover { background-color: #f9f9f9; } .back-link { display:inline-block; margin-top: 20px; color:#667eea; text-decoration:none; font-weight: 600; } .two-column-layout { display: flex; gap: 40px; margin: 40px 0; } .column { flex: 1; min-width: 0; } .progress-item { margin-bottom: 12px; } .progress-label { margin-bottom: 5px; font-size: 14px; color: #555; } .progress-bar-container { width: 100%; background-color: #EAE9E4; border-radius: 5px; overflow: hidden; } .progress-bar { height: 20px; background-color: #4A90E2; text-align: right; line-height: 20px; color: white; font-size: 12px; font-weight: bold; padding-right: 8px; border-radius: 5px 0 0 5px; } @media (max-width: 768px) { .two-column-layout { flex-direction: column; } .avatar { display: none; } } </style> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet"> </head> <body> <div class="container"> <div class="intro-panel"> <div class="intro-text"> <h1>${escapeHtml(zak['osloven√≠ 2. p√°d'])} Hudebn√≠ cesta</h1> <p>Hudebn√≠ n√°stroj: ${escapeHtml(zak['P≈ôedmƒõt'] || '')}, Roƒçn√≠k: ${escapeHtml(zak['Roƒçn√≠k'] || '')}</p> <a onclick="scrollDown()" class="scroll-button">Zobrazit, co cviƒçit na p≈ô√≠≈°tƒõ</a> </div> <img src="${avatarData}" alt="Avatar" class="avatar"> </div> <div class="two-column-layout"> <div class="column"> <h2 class="section-title">Na ƒçem pracujeme</h2> <ul style="list-style: 'üéµ '; padding-left: 20px;"> ${naCemPracujemeHTML} </ul> </div> <div class="column"> <h2 class="section-title">Pr≈Øbƒõh uƒçen√≠</h2> ${pruvbehUcUeniHTML} </div> </div> `; // Sekce: Cviƒçen√≠ na p≈ô√≠≈°tƒõ html += `<div class="section" id="cviceni-na-priste"><h2 class="section-title">Cviƒçen√≠ na p≈ô√≠≈°tƒõ</h2>`; if (cviceniNaPriste) { html += ` <table class="task-table"> <thead> <tr> <th>Skladba</th> <th>N√°zev √∫kolu</th> <th>Status</th> <th>Datum</th> </tr> </thead> <tbody> <tr> <td>${escapeHtml(cviceniNaPriste['Skladba'])}</td> <td>${escapeHtml(cviceniNaPriste['N√°zev √∫kolu'])}</td> <td>${escapeHtml(cviceniNaPriste['Stav √∫kolu'])}</td> <td>${safeDateToCz(cviceniNaPriste['Datum'])}</td> </tr> </tbody> </table> `; } else { html += '<p>≈Ω√°dn√© nov√© cviƒçen√≠ nebylo zad√°no.</p>'; } html += `</div>`; // Sekce: P≈ôedchoz√≠ √∫koly if (predchoziUkoly.length > 0) { html += `<div class="section"><h2 class="section-title">P≈ôedchoz√≠ √∫koly</h2> <table class="task-table"> <thead> <tr> <th>Skladba</th> <th>N√°zev √∫kolu</th> <th>Status</th> <th>Datum</th> </tr> </thead> <tbody>`; predchoziUkoly.forEach(ukol => { html += ` <tr> <td>${escapeHtml(ukol['Skladba'])}</td> <td>${escapeHtml(ukol['N√°zev √∫kolu'])}</td> <td>${escapeHtml(ukol['Stav √∫kolu'])}</td> <td>${safeDateToCz(ukol['Datum'])}</td> </tr> `; }); html += `</tbody></table></div>`; } html += `<a href="${baseUrl}" class="back-link">‚Üê Zpƒõt na rozcestn√≠k</a>`; html += `</div> <script> function scrollDown() { var target = document.getElementById('cviceni-na-priste'); if (target) { target.scrollIntoView({ behavior: 'smooth' }); } } </script> </body></html>`; return html; } // =============================================================== // UNIVERZ√ÅLN√ç POMOCN√â FUNKCE // =============================================================== function sheetToObjectArray(sheet) { if (!sheet) return []; const values = sheet.getDataRange().getValues(); if (!values || values.length < 2) return []; const headers = values.shift().map(h => (typeof h === 'string' ? h.trim() : h)); return values.map(row => { const obj = {}; headers.forEach((header, i) => { let val = row[i]; if (typeof val === 'string') val = val.trim(); obj[header] = (val === null || val === undefined) ? '' : val; }); return obj; }); } function getImageAsBase64(url) { if (!url || typeof url !== 'string') return 'https://via.placeholder.com/100'; // Zkus√≠me nejd≈ô√≠ve naƒç√≠st obr√°zek z Drive const driveIdMatch = url.match(/file\/d\/([a-zA-Z0-9_-]+)/); if (driveIdMatch && driveIdMatch[1]) { try { const file = DriveApp.getFileById(driveIdMatch[1]); const blob = file.getBlob(); return 'data:' + blob.getContentType() + ';base64,' + Utilities.base64Encode(blob.getBytes()); } catch(e) { Logger.log('Nepoda≈ôilo se naƒç√≠st obr√°zek z Google Drive: ' + e.toString()); } } // Pokud je to URL z jin√©ho webu try { const response = UrlFetchApp.fetch(url, { muteHttpExceptions: true }); if (response.getResponseCode() == 200) { const blob = response.getBlob(); return 'data:' + blob.getContentType() + ';base64,' + Utilities.base64Encode(blob.getBytes()); } } catch(e) { Logger.log('Nepoda≈ôilo se naƒç√≠st obr√°zek z extern√≠ URL: ' + e.toString()); } return 'https://via.placeholder.com/100'; } function normalizovatNazev(text) { if (!text) return ''; return text.toString().toLowerCase().replace(/\s+/g, '-').normalize('NFD').replace(/[\u0300-\u036f]/g, '').replace(/[^a-z0-9-]/g, ''); } function normStr(s) { return s == null ? '' : s.toString().trim(); } function strEq(a, b) { return normStr(a) === normStr(b); } function safeDateToCz(d) { try { if (!d) return ''; const date = new Date(d); return isNaN(date.getTime()) ? '' : date.toLocaleDateString('cs-CZ'); } catch (e) { return ''; } } function escapeHtml(s) { if (s == null) return ''; return s.toString().replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/"/g, '&quot;').replace(/'/g, '''); }" 1. zmen≈°i √∫vodn√≠ nadpis **Hudebn√≠ cesta, proto≈æe p≈ôekr√Ωv√° Avatar.** - na v≈°ech za≈ô√≠zen√≠ch aby byl ok. 2. **Sekce Na ƒçem pracujeme a ‚ÄúPr≈Øbƒõh uƒçen√≠‚Äù dej taky do b√≠l√Ωch box≈Ø.** 3. **‚ÄúCviƒçen√≠ na p≈ô√≠≈°tƒõ‚Äù by mƒõly b√Ωt v≈°echny kter√© nemaj√≠ status ‚Äú‚úÖ Zvl√°dnuto‚Äù ne jenom jedno. S ‚Äú‚úÖ Zvl√°dnuto‚Äù bude pak v ‚ÄúP≈ôedchoz√≠ √∫koly‚Äù** 4. **Pr≈Øbƒõh uƒçen√≠ - progres bary budou jen 1-10 bod≈Ø (10 dokonƒçeno) ne na procenta.** 5. Udƒõlat ≈°ir≈°√≠, nyn√≠ zab√≠r√° jen p≈Øl obrazovky. z√°rove≈à mus√≠ b√Ωt responzivn√≠ i pro mobily apod. 6. v ‚Äú**Cviƒçen√≠ na p≈ô√≠≈°tƒõ ‚Äúa ‚ÄúP≈ôedchoz√≠ √∫koly‚Äù je prvn√≠** sloupec ‚ÄúSkladba‚Äù - p≈ôi kliknut√≠ na skladbu se rozev≈ôe seznam Materi√°l≈Ø (url) jako rozbalovac√≠ nab√≠dka - z listu Skaldby sloupec ‚ÄúMateri√°ly‚Äù - m≈Ø≈æe tam b√Ωt v√≠ce url oddƒõlen√© ƒç√°rkami. Dal≈°√≠ ≈ô√°dky pod t√≠m se p≈ôi tom posunou dol≈Ø.
jen≈æe kdy≈æ tam d√°m admin token, tak se naƒç√≠t√° po≈ô√°d demo: inject.ts:28 pageshow:  PageTransitionEvent
hudebni-nastenky/?token=242d31145f5dae7e8c61:1  Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received
hudebni-nastenky/?token=242d31145f5dae7e8c61:1  Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received
hudebni-nastenky/?token=242d31145f5dae7e8c61:781 API failed, using fallback data: AbortError: signal is aborted without reason
    at hudebni-nastenky/?token=242d31145f5dae7e8c61:707:43
[NEW] Explain Console errors by using Copilot in Edge: click
         
         to explain an error. 
        Learn more
        Don't show again

https://studioosiris21-commits.github.io/hudebni-nastenky/?token=242d31145f5dae7e8c61

jen≈æe kdy≈æ tam d√°m admin token, tak se naƒç√≠t√° po≈ô√°d demo: inject.ts:28 pageshow: PageTransitionEvent hudebni-nastenky/?token=242d31145f5dae7e8c61:1 Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received hudebni-nastenky/?token=242d31145f5dae7e8c61:1 Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received hudebni-nastenky/?token=242d31145f5dae7e8c61:781 API failed, using fallback data: AbortError: signal is aborted without reason at hudebni-nastenky/?token=242d31145f5dae7e8c61:707:43 [NEW] Explain Console errors by using Copilot in Edge: click to explain an error. Learn more Don't show again https://studioosiris21-commits.github.io/hudebni-nastenky/?token=242d31145f5dae7e8c61
V admin re≈æimu po≈ô√°d pad√°te do demo re≈æimu, proto≈æe frontend ƒçte parametr token m√≠sto admin a z√°rove≈à st√°le pou≈æ√≠v√° fetch s CORS, kter√Ω p≈ôi admin URL bez JSONP timeoutuje; v√Ωsledkem je AbortError a fallback na demo. Opravte dvƒõ vƒõci:

1) Otev√≠rejte admin URL s kl√≠ƒçem admin, ne token
Spr√°vn√° adresa pro admin mus√≠ vypadat takto:

https://studioosiris21-commits.github.io/hudebni-nastenky/?admin=242d31145f5dae7e8c61
Ne:

https://studioosiris21-commits.github.io/hudebni-nastenky/?token=242d31145f5dae7e8c61
Frontend v k√≥du kontroluje kl√≠ƒç admin pro nastaven√≠ appState.isAdmin a p≈ôid√°n√≠ admin parametru do API vol√°n√≠; s tokenem m√≠sto admin vol√°te studentsk√Ω endpoint a nav√≠c to kv≈Øli CORS pad√° na timeout, tak≈æe se pou≈æije fallback demo data.

2) P≈ôepnƒõte frontend na JSONP loader
Va≈°e index.html st√°le pou≈æ√≠v√° fetch(), kter√Ω je u GAS bez CORS hlaviƒçek blokovan√Ω. Proto p≈ôi admin re≈æimu timeout (AbortError) a fallback. Nahraƒète celou funkci fetchAPI() touto JSONP verz√≠:

javascript
async function fetchAPI() {
  const p = new URLSearchParams(location.search);
  const admin = p.get('admin');
  const token = p.get('token');

  let url = CONFIG.apiBaseUrl + '?format=json';
  if (admin) url += '&admin=' + encodeURIComponent(admin);
  else if (token) url += '&token=' + encodeURIComponent(token);

  const cb = 'jsonp_cb_' + Date.now();
  url += '&callback=' + cb;

  return new Promise((resolve, reject) => {
    const s = document.createElement('script');
    window[cb] = (payload) => {
      try { resolve(payload); }
      finally {
        delete window[cb];
        s.remove();
      }
    };
    s.onerror = () => {
      delete window[cb];
      s.remove();
      reject(new Error('JSONP failed'));
    };
    s.src = url;
    document.head.appendChild(s);

    setTimeout(() => {
      if (window[cb]) {
        delete window[cb];
        s.remove();
        reject(new Error('JSONP timeout'));
      }
    }, CONFIG.timeoutMs || 8000);
  });
}
Pot√©:

Otev≈ôete admin URL se spr√°vn√Ωm parametrem: ?admin=242d31145f5dae7e8c61

V Network u /exec uvid√≠te n√°vrat JavaScriptu (callback({...})); v konzoli zmiz√≠ AbortError; fallback se nepou≈æije.

Dopl≈àuj√≠c√≠ kontrola:

V GAS k√≥du mus√≠ student vƒõtev vracet { success:true, userType:'student', data: studentData } a admin vƒõtev { success:true, userType:'admin', data: data }.

V mapov√°n√≠ na frontendu o≈°et≈ôete admin i student payload:

studentsArray = data.students || data.zaci || (data.student ? [data.student] : [])

a pak renderStats(); applyFilters(); aby se grid ihned naplnil.

Po tƒõchto dvou zmƒõn√°ch se admin data naƒçtou ≈æivƒõ a demo se u≈æ nepou≈æije.

ale i u 	https://studioosiris21-commits.github.io/hudebni-nastenky/?admin=242d31145f5dae7e8c61 jsou jendemo data. Oprav to u≈æ koneƒçnƒõ, hroznƒõ se v tom mot√°≈°!!! konsole: inject.ts:28 pageshow:  PageTransitionEvent
hudebni-nastenky/?admin=242d31145f5dae7e8c61:1  Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received
hudebni-nastenky/?admin=242d31145f5dae7e8c61:1  Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received
hudebni-nastenky/?admin=242d31145f5dae7e8c61:781 API failed, using fallback data: AbortError: signal is aborted without reason
    at hudebni-nastenky/?admin=242d31145f5dae7e8c61:707:43
[NEW] Explain Console errors by using Copilot in Edge: click
         
         to explain an error. 
        Learn more
        Don't show again
 Oprav chyby a po≈°li mi kompletn√≠ kody, ale u≈æ FUNKƒåN√ç!

ale i u https://studioosiris21-commits.github.io/hudebni-nastenky/?admin=242d31145f5dae7e8c61 jsou jendemo data. Oprav to u≈æ koneƒçnƒõ, hroznƒõ se v tom mot√°≈°!!! konsole: inject.ts:28 pageshow: PageTransitionEvent hudebni-nastenky/?admin=242d31145f5dae7e8c61:1 Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received hudebni-nastenky/?admin=242d31145f5dae7e8c61:1 Unchecked runtime.lastError: A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received hudebni-nastenky/?admin=242d31145f5dae7e8c61:781 API failed, using fallback data: AbortError: signal is aborted without reason at hudebni-nastenky/?admin=242d31145f5dae7e8c61:707:43 [NEW] Explain Console errors by using Copilot in Edge: click to explain an error. Learn more Don't show again Oprav chyby a po≈°li mi kompletn√≠ kody, ale u≈æ FUNKƒåN√ç!
KOMPLETN√ç FUNKƒåN√ç K√ìDY:

Google Apps Script (vlo≈æte do K√≥d.gs)

gas-kod-komplet.js
Generovan√Ω soubor
Index.html (nahraƒète cel√Ω sv≈Øj index.html)

index-komplet.html
Generovan√Ω soubor
Co opraveno:

GAS - ƒçist√Ω JSONP bez setHeader

Frontend - JSONP fetch m√≠sto klasick√©ho fetch

Mapov√°n√≠ - oprava pro admin i student payload

URL - v CONFIG pou≈æ√≠v√° va≈°i novou URL

Nasazen√≠:

Vlo≈æte k√≥d do GAS ‚Üí Ulo≈æit ‚Üí Deploy ‚Üí Web app ‚Üí Anyone

Vlo≈æte k√≥d na GitHub (nahraƒète cel√Ω index.html)

Otev≈ôete: https://studioosiris21-commits.github.io/hudebni-nastenky/?admin=242d31145f5dae7e8c61

Po tƒõchto kroc√≠ch se naƒçtou ≈æiv√° data z Google Sheets m√≠sto demo!

Vl√°kno se prodlu≈æuje. Zaƒçnƒõte nov√© pro lep≈°√≠ odpovƒõdi.





index-komplet.html
Generovan√Ω soubor
<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Spr√°va hudebn√≠ch ≈æ√°k≈Ø</title>
  <style>
    :root {
      --bg:#0f172a; --card:#111827; --muted:#9ca3af; --text:#e5e7eb; --accent:#22c55e; --accent2:#3b82f6;
      --danger:#ef4444; --warning:#eab308; --surface:#1f2937; --border:#374151;
    }
    * { box-sizing: border-box; }
    html,body { margin:0; padding:0; background:var(--bg); color:var(--text); font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; }
    .container { max-width: 1200px; margin: 0 auto; padding: 16px; }
    h1 { margin: 0 0 16px 0; font-size: 26px; font-weight: 700; }
    h2 { font-size: 20px; margin: 0 0 12px 0; }
    
    /* Navigation */
    .nav { display:flex; gap:12px; align-items:center; margin-bottom: 20px; flex-wrap: wrap; }
    .nav-btn { padding:8px 16px; border-radius:8px; border:1px solid var(--border); background:var(--card); color:var(--text); text-decoration:none; cursor:pointer; transition:all 0.2s; }
    .nav-btn:hover { background:var(--surface); }
    .nav-btn.active { background:var(--accent); color:white; }
    
    /* Controls */
    .controls { display:flex; gap:12px; flex-wrap: wrap; margin-bottom: 16px; }
    .select { background:var(--card); color:var(--text); border:1px solid var(--border); padding:10px 12px; border-radius:8px; min-width:160px; }
    .btn { padding:10px 16px; border-radius:8px; border:none; cursor:pointer; font-weight:500; transition:all 0.2s; }
    .btn-primary { background:var(--accent); color:white; }
    .btn-primary:hover { opacity:0.9; transform:translateY(-1px); }
    .btn-danger { background:var(--danger); color:white; }
    .btn-secondary { background:var(--surface); color:var(--text); border:1px solid var(--border); }
    
    /* Stats */
    .stats { display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:14px; margin: 12px 0 20px; }
    .stat {
Aktivum 2 z 2
